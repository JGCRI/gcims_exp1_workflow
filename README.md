# gcims_exp1_workflow
GCIMS Experiment 1 Workflow

## Processing environment
Processing of the climate data and Xanthos simulations were conducted on a PNNL High Performance Computing (HPC) cluster named Deception (deception.pnl.gov) with an initial configuration consists of 96 compute nodes boasting a total of 6,144 CPU cores powered by dual AMD EPYC 7502 CPUs. The CPUs run at 2.5 GHz with the ability to boost to 3.35 GHz. 

The SLURM scripts are written to execute from a BASH shell.

## Pre-processing

### Xanthos calibration
Xanthos was calibrated to GSWP3 using the following steps.

### Quality control of climate data
Describe steps for the QC of the climate data.

## Simulation workflow

### Generate configuration files
Generate configuration files for each scenario, model, realization combination.  This uses the `data/template.ini` file found in this repository.
Configuration files are generated by executing the following from `/rcfs/projects/gcims/projects/mit_climate/code/gcims_exp1_workflow` on Deception:
```bash
sbatch /rcfs/projects/gcims/projects/mit_climate/code/gcims_exp1_workflow/scripts/generate_config_files.sl
```
This command triggers the `scripts/generate_config_files.py` Python file.

### Process historical data
Convert the historical baseline data into the input format that Xanthos expects.  This data will be stitched to the future data during the future simulations.

### Process future data and run Xanthos per realization
This step does the following for each scenario, model, realization:
- converts the climate data to the format that Xanthos expects and stitches the historical period to the start 
- runs xanthos and generates outputs for:
  - potential evapotranspiration (PET) in units km<sup>3</sup>/month
  - actual evapotranspiration (AET) in units km<sup>3</sup>/month
  - runoff (Q) in units km<sup>3</sup>/month
  - soil moisture in units km<sup>3</sup>/month
  - average channel flow in units m<sup>3</sup>/second
  - basin aggregated runoff in units km<sup>3</sup>/month
  - country aggregated runoff in units km<sup>3</sup>/month
  - GCAM region aggregated runoff in units km<sup>3</sup>/month
  - drought severity, intensity, and duration
- deletes the converted climate data 

### Convert the Xanthos outputs to the XML structure needed for GCAM
Convert the Xanthos output files to the XML structure needed for GCAM

### Run GCAM
Run GCAM

## Post-processing quality control
Describe steps for the QC of the Xanthos and GCAM output data.
